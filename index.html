<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self';">
    <title>ç¦»çº¿ BIP39 åŠ©è®°è¯ç”Ÿæˆå™¨ | Offline BIP39 Mnemonic Generator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ” ç¦»çº¿ BIP39 åŠ©è®°è¯ç”Ÿæˆå™¨</h1>
            <h2>Offline BIP39 Mnemonic Generator</h2>
            <div class="warning-banner">
                âš ï¸ è­¦å‘Š / WARNING: è¯·åœ¨å®Œå…¨ç¦»çº¿çš„ç¯å¢ƒä¸­ä½¿ç”¨æ­¤å·¥å…· / Use this tool in a completely offline environment
            </div>
        </header>

        <main>
            <!-- é…ç½®åŒº -->
            <section class="config-section">
                <h3>é…ç½® / Configuration</h3>
                
                <div class="form-group">
                    <label>åŠ©è®°è¯é•¿åº¦ / Mnemonic Length:</label>
                    <select id="wordCount">
                        <option value="12">12 è¯ / Words (128-bit entropy)</option>
                        <option value="24">24 è¯ / Words (256-bit entropy)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>è¯­è¨€ / Language:</label>
                    <select id="language">
                        <option value="english">English</option>
                        <option value="chinese_simplified">ç®€ä½“ä¸­æ–‡</option>
                        <option value="chinese_traditional">ç¹é«”ä¸­æ–‡</option>
                        <option value="japanese">æ—¥æœ¬èª</option>
                        <option value="korean">í•œêµ­ì–´</option>
                        <option value="french">FranÃ§ais</option>
                        <option value="italian">Italiano</option>
                        <option value="spanish">EspaÃ±ol</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>å¯é€‰å¯†ç çŸ­è¯­ / Optional Passphrase (BIP39 Extension):</label>
                    <input type="password" id="passphrase" placeholder="ç•™ç©ºè¡¨ç¤ºæ— å¯†ç  / Leave empty for no passphrase">
                    <small>å¯†ç çŸ­è¯­ä½œä¸ºç¬¬25ä¸ªè¯ï¼Œå¢å¼ºå®‰å…¨æ€§ / Passphrase acts as a 25th word for enhanced security</small>
                </div>
            </section>

            <!-- ç†µæºæ”¶é›† -->
            <section class="entropy-section">
                <h3>ç†µæºæ”¶é›† / Entropy Collection</h3>
                
                <div class="entropy-info">
                    <p>å½“å‰ç†µæ± çŠ¶æ€ / Current Entropy Pool: <span id="entropyStatus">0 bits</span></p>
                    <div class="entropy-bar">
                        <div id="entropyProgress" class="entropy-fill"></div>
                    </div>
                </div>

                <div class="entropy-methods">
                    <div class="form-group">
                        <label>é¼ æ ‡ç§»åŠ¨æ”¶é›†ç†µ / Mouse Movement Entropy:</label>
                        <div id="mouseEntropyCanvas" class="entropy-canvas">
                            åœ¨æ­¤åŒºåŸŸç§»åŠ¨é¼ æ ‡ä»¥æ”¶é›†ç†µ / Move mouse here to collect entropy
                        </div>
                    </div>

                    <div class="form-group">
                        <label>éª°å­æŠ•æ· / Dice Rolls (1-6):</label>
                        <input type="text" id="diceRolls" placeholder="ä¾‹å¦‚ / e.g.: 4,2,6,1,5,3...">
                        <button onclick="addDiceEntropy()">æ·»åŠ éª°å­ç†µ / Add Dice Entropy</button>
                    </div>

                    <div class="form-group">
                        <label>è‡ªå®šä¹‰ç†µ (åå…­è¿›åˆ¶) / Custom Entropy (Hex):</label>
                        <input type="text" id="customEntropy" placeholder="ä¾‹å¦‚ / e.g.: a1b2c3d4...">
                        <button onclick="addCustomEntropy()">æ·»åŠ è‡ªå®šä¹‰ç†µ / Add Custom Entropy</button>
                    </div>
                </div>

                <div class="entropy-source-info">
                    <p><strong>ç†µæºæ··åˆæ–¹æ¡ˆ / Entropy Mixing Scheme:</strong></p>
                    <ul>
                        <li>ç³»ç»Ÿ CSPRNG (crypto.getRandomValues) / System CSPRNG</li>
                        <li>ç”¨æˆ·è¾“å…¥ç†µï¼ˆé¼ æ ‡ã€éª°å­ã€è‡ªå®šä¹‰ï¼‰ / User Input Entropy</li>
                        <li>æ—¶é—´æˆ³çº³ç§’çº§å˜åŒ– / High-resolution Timestamp</li>
                        <li>æ··åˆæ–¹æ³•ï¼šSHA-256(CSPRNG || UserEntropy || Timestamp) / Mixing: SHA-256</li>
                    </ul>
                </div>
            </section>

            <!-- ç”ŸæˆæŒ‰é’® -->
            <section class="generate-section">
                <button id="generateBtn" class="primary-btn" onclick="generateMnemonic()">
                    ğŸ² ç”Ÿæˆæ–°åŠ©è®°è¯ / Generate New Mnemonic
                </button>
                <button class="secondary-btn" onclick="loadTestMnemonic()">
                    ğŸ“‹ åŠ è½½æµ‹è¯•åŠ©è®°è¯ / Load Test Mnemonic
                </button>
                <button class="danger-btn" onclick="clearAll()">
                    ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰æ•°æ® / Clear All Data
                </button>
            </section>

            <!-- ç»“æœæ˜¾ç¤º -->
            <section id="resultSection" class="result-section" style="display: none;">
                <h3>ç”Ÿæˆç»“æœ / Generated Results</h3>
                
                <div class="result-group">
                    <label>BIP39 åŠ©è®°è¯ / BIP39 Mnemonic:</label>
                    <div class="result-box mnemonic-box" id="mnemonicResult"></div>
                    <button onclick="copyToClipboard('mnemonicResult')">å¤åˆ¶ / Copy</button>
                </div>

                <div class="result-group">
                    <label>BIP39 ç§å­ (Hex) / BIP39 Seed (Hex):</label>
                    <div class="result-box" id="seedResult"></div>
                    <button onclick="copyToClipboard('seedResult')">å¤åˆ¶ / Copy</button>
                    <small>ä½¿ç”¨ PBKDF2-HMAC-SHA512, 2048 æ¬¡è¿­ä»£ / Using PBKDF2-HMAC-SHA512, 2048 iterations</small>
                </div>

                <div class="result-group">
                    <label>æ ¹å¯†é’¥ (Master Key) / Root Key:</label>
                    <div class="result-box" id="masterKeyResult"></div>
                    <small>BIP32 æ ¹æ‰©å±•å¯†é’¥ / BIP32 Root Extended Key</small>
                </div>
            </section>

            <!-- æ´¾ç”Ÿè·¯å¾„ -->
            <section id="derivationSection" class="derivation-section" style="display: none;">
                <h3>æ´¾ç”Ÿè·¯å¾„ / Derivation Paths</h3>
                
                <div class="derivation-info">
                    <p><strong>âš ï¸ é‡è¦ / IMPORTANT:</strong> å¯¼å…¥é’±åŒ…æ—¶å¿…é¡»ä½¿ç”¨æ­£ç¡®çš„æ´¾ç”Ÿè·¯å¾„ / Must use correct derivation path when importing to wallets</p>
                </div>

                <div class="path-presets">
                    <h4>å¸¸ç”¨æ´¾ç”Ÿè·¯å¾„ / Common Derivation Paths:</h4>
                    <div class="path-buttons">
                        <button onclick="derivePath('m/44\'/60\'/0\'/0/0')">Ethereum (m/44'/60'/0'/0/0)</button>
                        <button onclick="derivePath('m/44\'/0\'/0\'/0/0')">Bitcoin Legacy (m/44'/0'/0'/0/0)</button>
                        <button onclick="derivePath('m/84\'/0\'/0\'/0/0')">Bitcoin Native SegWit (m/84'/0'/0'/0/0)</button>
                        <button onclick="derivePath('m/49\'/0\'/0\'/0/0')">Bitcoin SegWit (m/49'/0'/0'/0/0)</button>
                        <button onclick="derivePath('m/44\'/60\'/0\'/0')">imToken ETH (m/44'/60'/0'/0)</button>
                        <button onclick="derivePath('m/44\'/195\'/0\'/0/0')">TRON (m/44'/195'/0'/0/0)</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>è‡ªå®šä¹‰æ´¾ç”Ÿè·¯å¾„ / Custom Derivation Path:</label>
                    <input type="text" id="customPath" placeholder="ä¾‹å¦‚ / e.g.: m/44'/60'/0'/0/0">
                    <button onclick="deriveCustomPath()">æ´¾ç”Ÿ / Derive</button>
                </div>

                <div id="derivedResults" class="derived-results"></div>
            </section>

            <!-- é’±åŒ…å¯¼å…¥æŒ‡å— -->
            <section class="wallet-guide">
                <h3>é’±åŒ…å¯¼å…¥æŒ‡å— / Wallet Import Guide</h3>
                
                <div class="wallet-card">
                    <h4>imToken</h4>
                    <ol>
                        <li>æ‰“å¼€ imTokenï¼Œé€‰æ‹©"å¯¼å…¥é’±åŒ…" / Open imToken, select "Import Wallet"</li>
                        <li>é€‰æ‹©"åŠ©è®°è¯" / Select "Mnemonic"</li>
                        <li>è¾“å…¥ BIP39 åŠ©è®°è¯ / Enter BIP39 mnemonic</li>
                        <li>ç¡®è®¤æ´¾ç”Ÿè·¯å¾„ï¼šETH ä½¿ç”¨ m/44'/60'/0'/0 / Confirm derivation path</li>
                    </ol>
                </div>

                <div class="wallet-card">
                    <h4>MetaMask</h4>
                    <ol>
                        <li>æ‰“å¼€ MetaMaskï¼Œé€‰æ‹©"å¯¼å…¥é’±åŒ…" / Open MetaMask, select "Import Wallet"</li>
                        <li>è¾“å…¥ 12 æˆ– 24 è¯åŠ©è®°è¯ / Enter 12 or 24 word mnemonic</li>
                        <li>é»˜è®¤ä½¿ç”¨ m/44'/60'/0'/0/0 è·¯å¾„ / Default uses m/44'/60'/0'/0/0 path</li>
                    </ol>
                </div>

                <div class="wallet-card">
                    <h4>ç¡¬ä»¶é’±åŒ… / Hardware Wallets (Ledger/Trezor)</h4>
                    <ol>
                        <li>æŒ‰ç…§ç¡¬ä»¶é’±åŒ…æ¢å¤æµç¨‹ / Follow hardware wallet recovery process</li>
                        <li>ä¾æ¬¡è¾“å…¥åŠ©è®°è¯ / Enter mnemonic words in order</li>
                        <li>ç¡®è®¤æ´¾ç”Ÿè·¯å¾„è®¾ç½® / Confirm derivation path settings</li>
                    </ol>
                </div>
            </section>

            <!-- æµ‹è¯•å‘é‡ -->
            <section class="test-vectors">
                <h3>æµ‹è¯•å‘é‡ / Test Vectors</h3>
                <details>
                    <summary>æŸ¥çœ‹ BIP39 å·²çŸ¥æµ‹è¯•å‘é‡ / View BIP39 Known Test Vectors</summary>
                    <div class="test-vector-content">
                        <pre id="testVectors">åŠ è½½ä¸­... / Loading...</pre>
                    </div>
                </details>
            </section>

            <!-- å®‰å…¨æç¤º -->
            <section class="security-tips">
                <h3>ğŸ›¡ï¸ å®‰å…¨æç¤º / Security Tips</h3>
                <ul>
                    <li>âœ… è¯·åœ¨å®Œå…¨ç¦»çº¿çš„ç¯å¢ƒä¸­ç”ŸæˆåŠ©è®°è¯ / Generate mnemonic in completely offline environment</li>
                    <li>âœ… å»ºè®®ä½¿ç”¨ air-gapped è®¡ç®—æœºæˆ– USB å¯åŠ¨çš„ Linux / Use air-gapped computer or USB-booted Linux</li>
                    <li>âœ… å¦¥å–„ä¿ç®¡åŠ©è®°è¯ï¼ŒæŠ„å†™åœ¨çº¸ä¸Šå¹¶å­˜æ”¾åœ¨å®‰å…¨çš„åœ°æ–¹ / Store mnemonic safely, write on paper and keep secure</li>
                    <li>âœ… æ°¸è¿œä¸è¦åœ¨è”ç½‘è®¾å¤‡ä¸Šè¾“å…¥æˆ–æ‹æ‘„åŠ©è®°è¯ / Never enter or photograph mnemonic on internet-connected device</li>
                    <li>âœ… æµ‹è¯•åŠ©è®°è¯ä»…ç”¨äºæ¼”ç¤ºï¼Œåˆ‡å‹¿ç”¨äºçœŸå®èµ„äº§ / Test mnemonics are for demo only, never use for real assets</li>
                    <li>âœ… éªŒè¯ä¸‹è½½æ–‡ä»¶çš„ SHA256 å“ˆå¸Œå’Œ GPG ç­¾å / Verify SHA256 hash and GPG signature of downloaded files</li>
                    <li>â›” æœ¬å·¥å…·ä¸ä¼šå‘ä»»ä½•æœåŠ¡å™¨å‘é€æ•°æ® / This tool sends no data to any server</li>
                    <li>â›” ä¸ä¼šè‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿ / No automatic clipboard copying</li>
                </ul>
            </section>
        </main>

        <footer>
            <p>ç‰ˆæœ¬ / Version: 1.0.0 | æ„å»ºå“ˆå¸Œ / Build Hash: <span id="buildHash">åŠ è½½ä¸­...</span></p>
            <p>å¼€æºé¡¹ç›® / Open Source Project | å¯å®¡è®¡ã€å¯å¤ç°æ„å»º / Auditable, Reproducible Build</p>
            <p>âš ï¸ è¯·å®¡è®¡æºä»£ç åä½¿ç”¨ / Please audit source code before use</p>
        </footer>
    </div>

    <script src="crypto-utils.js"></script>
    <script src="bip39.js"></script>
    <script src="bip32.js"></script>
    <script src="app.js"></script>
</body>
</html>
